{"version":3,"sources":["../src/BezierEditor.js"],"names":["onEnterHandle","h","state","down","setState","hover","onDownHandle","e","preventDefault","onLeaveHandle","BezierEditor","onEnterHandle1","bind","onEnterHandle2","onLeaveHandle1","onLeaveHandle2","onDownHandle1","onDownHandle2","onDownLeave","onDownMove","i","value","concat","props","positionForEvent","x","y","inversex","inversey","onChange","onDownUp","rect","refs","root","getBoundingClientRect","clientX","left","clientY","top","padding","w","width","Math","round","max","min","height","handleRadius","clampMargin","style","className","progress","handleStroke","background","gridColor","curveColor","curveWidth","handleColor","textStyle","progressColor","readOnly","pointers","sharedProps","xFrom","yFrom","xTo","yTo","cursor","propTypes","styles","def","userSelect","WebkitUserSelect","MozUserSelect","containerEvents","onMouseMove","onMouseUp","onMouseLeave","handle1Events","onMouseDown","onMouseEnter","handle2Events","defaultProps","children","undefined","Component","PropTypes","array","func","number","object","string","color","bool","fontFamily","fontSize"],"mappings":"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","file":"BezierEditor.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport Grid from \"./Grid\";\nimport Handle from \"./Handle\";\nimport Progress from \"./Progress\";\nimport Curve from \"./Curve\";\n\nfunction onEnterHandle(h) {\n  if (!this.state.down) {\n    this.setState({\n      hover: h,\n    });\n  }\n}\nfunction onDownHandle(h, e) {\n  e.preventDefault();\n  this.setState({\n    hover: null,\n    down: h,\n  });\n}\n\nfunction onLeaveHandle() {\n  if (!this.state.down) {\n    this.setState({\n      hover: null,\n    });\n  }\n}\n\nexport default class BezierEditor extends Component {\n  static propTypes = {\n    value: PropTypes.array,\n    onChange: PropTypes.func,\n    width: PropTypes.number,\n    height: PropTypes.number,\n    padding: PropTypes.array,\n    handleRadius: PropTypes.number,\n    style: PropTypes.object,\n    className: PropTypes.string,\n    progress: PropTypes.number,\n    handleStroke: PropTypes.number,\n    background: PropTypes.string,\n    gridColor: PropTypes.string,\n    curveColor: PropTypes.string,\n    curveWidth: PropTypes.number,\n    handleColor: PropTypes.string,\n    color: PropTypes.string,\n    textStyle: PropTypes.object,\n    progressColor: PropTypes.string,\n    readOnly: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    value: [0.25, 0.25, 0.75, 0.75],\n    width: 300,\n    height: 300,\n    padding: [25, 5, 25, 18],\n    progress: 0,\n    background: \"#fff\",\n    color: \"#000\", // FIXME what is color?\n    gridColor: \"#eee\",\n    curveColor: \"#333\",\n    progressColor: \"#ccc\",\n    handleColor: \"#f00\",\n    curveWidth: 2,\n    handleRadius: 5,\n    handleStroke: 2,\n    textStyle: {\n      fontFamily: \"sans-serif\",\n      fontSize: \"10px\",\n    },\n    pointers: {\n      down: \"none\",\n      hover: \"pointer\",\n      def: \"default\",\n    },\n  };\n\n  state = {\n    down: 0,\n    hover: 0,\n  };\n\n  onEnterHandle1 = onEnterHandle.bind(this, 1);\n  onEnterHandle2 = onEnterHandle.bind(this, 2);\n  onLeaveHandle1 = onLeaveHandle.bind(this, 1);\n  onLeaveHandle2 = onLeaveHandle.bind(this, 2);\n  onDownHandle1 = onDownHandle.bind(this, 1);\n  onDownHandle2 = onDownHandle.bind(this, 2);\n\n  onDownLeave = e => {\n    if (this.state.down) {\n      this.onDownMove(e);\n      this.setState({\n        down: null,\n      });\n    }\n  };\n\n  onDownMove = e => {\n    if (this.state.down) {\n      e.preventDefault();\n      const i = 2 * (this.state.down - 1);\n      const value = [].concat(this.props.value);\n      const [x, y] = this.positionForEvent(e);\n      value[i] = this.inversex(x);\n      value[i + 1] = this.inversey(y);\n      this.props.onChange(value);\n    }\n  };\n\n  onDownUp = () => {\n    // this.onDownMove(e);\n    this.setState({\n      down: 0,\n    });\n  };\n\n  positionForEvent = e => {\n    const rect = this.refs.root.getBoundingClientRect();\n    return [e.clientX - rect.left, e.clientY - rect.top];\n  };\n\n  x = value => {\n    const padding = this.props.padding;\n    const w = this.props.width - padding[1] - padding[3];\n    return Math.round(padding[3] + value * w);\n  };\n\n  inversex = x => {\n    const padding = this.props.padding;\n    const w = this.props.width - padding[1] - padding[3];\n    return Math.max(0, Math.min((x - padding[3]) / w, 1));\n  };\n\n  y = value => {\n    const padding = this.props.padding;\n    const h = this.props.height - padding[0] - padding[2];\n    return Math.round(padding[0] + (1 - value) * h);\n  };\n\n  inversey = y => {\n    const { height, handleRadius, padding } = this.props;\n    const clampMargin = 2 * handleRadius;\n    const h = height - padding[0] - padding[2];\n    y = Math.max(clampMargin, Math.min(y, height - clampMargin));\n    return 1 - (y - padding[0]) / h;\n  };\n\n  render() {\n    const { x, y } = this;\n    const {\n      value,\n      width,\n      height,\n      handleRadius,\n      style,\n      className,\n      progress,\n      handleStroke,\n      background,\n      gridColor,\n      curveColor,\n      curveWidth,\n      handleColor,\n      textStyle,\n      progressColor,\n      readOnly,\n      pointers,\n    } = this.props;\n\n    const { down, hover } = this.state;\n\n    const sharedProps = {\n      xFrom: x(0),\n      yFrom: y(0),\n      xTo: x(1),\n      yTo: y(1),\n    };\n\n    const cursor = { ...BezierEditor.propTypes.pointers, ...pointers };\n\n    const styles = {\n      background,\n      cursor: down ? cursor.down : hover ? cursor.hover : cursor.def,\n      userSelect: \"none\",\n      WebkitUserSelect: \"none\",\n      MozUserSelect: \"none\",\n      ...style,\n    };\n\n    const containerEvents = readOnly || !down\n      ? {}\n      : {\n          onMouseMove: this.onDownMove,\n          onMouseUp: this.onDownUp,\n          onMouseLeave: this.onDownLeave,\n        };\n    const handle1Events = readOnly || down\n      ? {}\n      : {\n          onMouseDown: this.onDownHandle1,\n          onMouseEnter: this.onEnterHandle1,\n          onMouseLeave: this.onLeaveHandle1,\n        };\n    const handle2Events = readOnly || down\n      ? {}\n      : {\n          onMouseDown: this.onDownHandle2,\n          onMouseEnter: this.onEnterHandle2,\n          onMouseLeave: this.onLeaveHandle2,\n        };\n\n    return (\n      <svg\n        ref=\"root\"\n        className={className}\n        style={styles}\n        width={width}\n        height={height}\n        {...containerEvents}\n      >\n        <Grid\n          {...sharedProps}\n          background={background}\n          gridColor={gridColor}\n          textStyle={{ ...BezierEditor.defaultProps.textStyle, ...textStyle }}\n        />\n        <Progress\n          {...sharedProps}\n          value={value}\n          progress={progress}\n          progressColor={progressColor}\n        />\n        <Curve\n          {...sharedProps}\n          value={value}\n          curveColor={curveColor}\n          curveWidth={curveWidth}\n        />\n        {this.props.children}\n        {readOnly\n          ? undefined\n          : <g>\n              <Handle\n                {...sharedProps}\n                {...handle1Events}\n                index={0}\n                xval={value[0]}\n                yval={value[1]}\n                handleRadius={handleRadius}\n                handleColor={handleColor}\n                down={down === 1}\n                hover={hover === 1}\n                handleStroke={handleStroke}\n                background={background}\n              />\n              <Handle\n                {...sharedProps}\n                {...handle2Events}\n                index={1}\n                xval={value[2]}\n                yval={value[3]}\n                handleRadius={handleRadius}\n                handleColor={handleColor}\n                down={down === 2}\n                hover={hover === 2}\n                handleStroke={handleStroke}\n                background={background}\n              />\n            </g>}\n      </svg>\n    );\n  }\n}\n"]}